
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Mac Config</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            body {
                padding-top: 50px;
                padding-bottom: 20px;
            }
        </style>
        <link rel="stylesheet" href="css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="css/prism.css">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
        <script src="js/vendor/prism.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

    <div class="container">

      <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Mac Config</a>
<ul>
<li><a href="#sec-1-1">1.1. Introduction</a></li>
<li><a href="#sec-1-2">1.2. Overview</a></li>
<li><a href="#sec-1-3">1.3. OSX Settings</a></li>
<li><a href="#sec-1-4">1.4. Repositories and Dotfiles</a></li>
<li><a href="#sec-1-5">1.5. Applications</a>
<ul>
<li><a href="#sec-1-5-1">1.5.1. Screen Saver</a></li>
<li><a href="#sec-1-5-2">1.5.2. Window Management</a></li>
</ul>
</li>
<li><a href="#sec-1-6">1.6. Homebrew</a></li>
<li><a href="#sec-1-7">1.7. Git Configuration</a></li>
<li><a href="#sec-1-8">1.8. One Concern per File</a></li>
<li><a href="#sec-1-9">1.9. Bootstrapping</a></li>
<li><a href="#sec-1-10">1.10. Literate Programming</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Mac Config</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Introduction</h3>
<div class="outline-text-3" id="text-1-1">
<p>
This is the config for my Mac.
</p>

<p>
I like for certain applications to be installed.
</p>

<p>
I want my dot files to be automatically setup.
</p>

<p>
There are certain operating system settings I want one way or
another.
</p>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Overview</h3>
<div class="outline-text-3" id="text-1-2">
<p>
It is based in <a href="https://github.com/boxen/our-boxen/#our-boxen">Boxen</a>. The configuration can be reified with a
single command.
</p>

<p>
When it comes to applications this essentially lists <a href="http://brew.sh/">Homebrew</a> and
<a href="https://caskroom.github.io/">Homebrew Cask</a> packages.
</p>

<p>
Some things, like <a href="https://github.com/robbyrussell/oh-my-zsh">oh-my-zsh</a>, are installed by cloning a repository
and setting up links. Boxen can do that, too. This approach also
works for setting up dot-files.
</p>

<p>
Boxen can be extended with modules, and an example of such a module
is one that allows you to control OS settings such as mapping the
<code>CAPS LOCK</code> key to <code>CONTROL</code>.
</p>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> OSX Settings</h3>
<div class="outline-text-3" id="text-1-3">
<p>
The following settings are made possible via <a href="https://github.com/boxen/puppet-osx">puppet-osx</a>.
</p>

<div class="org-src-container">

<pre>
<code class='language-ruby'>class people::jedcn::osx_config {

  # ZSH
  osx_chsh { $::luser:
    shell   =&gt; '/opt/boxen/homebrew/bin/zsh',
    require =&gt; Package['zsh'],
  }

  file_line { 'add zsh to /etc/shells':
    path    =&gt; '/etc/shells',
    line    =&gt; "${boxen::config::homebrewdir}/bin/zsh",
    require =&gt; Package['zsh'],
  }

  # Dock Settings
  include osx::dock::autohide
  include osx::dock::clear_dock

  # Screen Zoom
  include osx::universal_access::ctrl_mod_zoom
  include osx::universal_access::enable_scrollwheel_zoom

  # Key Repeat
  class { 'osx::global::key_repeat_delay':
    delay =&gt; 10
  }
  include osx::global::key_repeat_rate

  # Capslock becomes Control
  include osx::keyboard::capslock_to_control

  # Hot Corners
  osx::dock::hot_corner { 'Show the desktop':
    position =&gt; 'Bottom Right',
    action =&gt; 'Desktop'
  }
  osx::dock::hot_corner { 'Put Display to Sleep':
    position =&gt; 'Bottom Left',
    action =&gt; 'Put Display to Sleep'
  }
  osx::dock::hot_corner { 'Start Screen Saver':
    position =&gt; 'Top Left',
    action =&gt; 'Start Screen Saver'
  }
  osx::dock::hot_corner { 'Mission Control':
    position =&gt; 'Top Right',
    action =&gt; 'Mission Control'
  }

  # Make Developer Tools available in Safari (ie: right-click and see
  # Inspect Element)
  include osx::safari::enable_developer_mode

  # Recovery Message
  $recovery_owner = "This computer belongs to Jed Northridge."
  $recovery_contact = "If found, please contact jedcn@jedcn.com or 305-985-3326."
  osx::recovery_message { "${recovery_owner} ${recovery_contact}": }
}
</code></pre>
</div>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/modules/people/manifests/jedcn/osx_config.pp">modules/people/manifests/jedcn/osx<sub>config</sub>.pp</a>.
</p>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Repositories and Dotfiles</h3>
<div class="outline-text-3" id="text-1-4">
<p>
Boxen can clone repositories:
</p>

<div class="org-src-container">

<pre>
<code class='language-ruby'>class people::jedcn::repositories {

  $my_init_src = '/opt/init-src'

  file { $my_init_src:
    ensure =&gt; directory,
    mode   =&gt; 0644,
  }

  repository { "${my_init_src}/dot-org-files":
    source  =&gt; 'jedcn/dot-org-files',
    require =&gt; File[$my_init_src]
  }

  repository { "${my_init_src}/oh-my-zsh":
    source  =&gt; 'robbyrussell/oh-my-zsh',
    require =&gt; File[$my_init_src]
  }

  repository { "${my_init_src}/cask":
    source  =&gt; 'cask/cask',
    require =&gt; File[$my_init_src]
  }

}
</code></pre>
</div>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/modules/people/manifests/jedcn/repositories.pp">modules/people/manifests/jedcn/repositories.pp</a>.
</p>

<p>
Boxen can setup links to cloned repositories:
</p>

<div class="org-src-container">

<pre>
<code class='language-ruby'>class people::jedcn::links {

  $my_init_src = '/opt/init-src'

  file { "/Users/${luser}/.zshrc":
    ensure  =&gt; link,
    mode    =&gt; '0644',
    target  =&gt; "${my_init_src}/dot-org-files/home/.zshrc",
    require =&gt; Repository["${my_init_src}/dot-org-files"],
  }

  file { "/Users/${luser}/.oh-my-zsh":
    ensure  =&gt; link,
    target  =&gt; "${my_init_src}/oh-my-zsh",
    require =&gt; Repository["${my_init_src}/oh-my-zsh"],
  }

  file { "/Users/${luser}/.cask":
    ensure  =&gt; link,
    target  =&gt; "${my_init_src}/cask",
    require =&gt; Repository["${my_init_src}/cask"],
  }

  file { "/Users/${luser}/.hammerspoon":
    ensure  =&gt; link,
    target  =&gt; "${my_init_src}/dot-org-files/home/.hammerspoon",
    require =&gt; Repository["${my_init_src}/dot-org-files"],
  }
}
</code></pre>
</div>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/modules/people/manifests/jedcn/repositories.pp">modules/people/manifests/jedcn/links.pp</a>.
</p>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Applications</h3>
<div class="outline-text-3" id="text-1-5">
<p>
I'm using Homebrew Cask for applications. The only exception is
<a href="https://github.com/boxen/puppet-chrome">puppet-crome</a>.
</p>

<div class="org-src-container">

<pre>
<code class='language-ruby'>class people::jedcn::applications {
  include chrome
  include chrome::canary

  include brewcask
  package { 'hammerspoon':
    provider =&gt; 'brewcask',
    require  =&gt; File["/Users/${luser}/.hammerspoon"],
  }

  package { 'aerial':
    provider =&gt; 'brewcask',
  }
}
</code></pre>
</div>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/modules/people/manifests/jedcn/applications.pp">modules/people/manifests/jedcn/applications.pp</a>.
</p>

<p>
Notes:
</p>
</div>

<div id="outline-container-sec-1-5-1" class="outline-4">
<h4 id="sec-1-5-1"><span class="section-number-4">1.5.1</span> Screen Saver</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
I've started using <a href="https://github.com/JohnCoates/Aerial">Aerial</a>.
</p>

<p>
After a boxen run, you still need to open System Preferences -&gt;
Desktop &amp; Screen Saver -&gt; Screen Saver, and select it.
</p>
</div>
</div>

<div id="outline-container-sec-1-5-2" class="outline-4">
<h4 id="sec-1-5-2"><span class="section-number-4">1.5.2</span> Window Management</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
I use Hammerspoon for window management.
</p>

<p>
After a boxen run, you still need to launch Hammerspoon and:
</p>

<ul class="org-ul">
<li>Enable Accessibility
</li>
<li>Select Launch Hammerspoon on Login
</li>
<li>Deselect Show Dock Icon
</li>
<li>Deselect Send Crash Data
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> Homebrew</h3>
<div class="outline-text-3" id="text-1-6">
<p>
These are the packages I like:
</p>

<div class="org-src-container">

<pre>
<code class='language-ruby'>class people::jedcn::homebrew {
  $homebrew_packages = [
			'ag',
			'tmux',
			'tree',
			'wget',
			'zsh',
			]

  package { $homebrew_packages: }

  package { 'cask':
    ensure  =&gt; present,
    require =&gt; Package['emacs'],
  }

  package { 'emacs':
    ensure          =&gt; present,
    install_options =&gt; [
      '--cocoa',
      '--srgb'
    ],
  }
}
</code></pre>
</div>

<p>
Notes:
</p>

<ul class="org-ul">
<li>I install emacs with options that I learned about in <a href="http://emacsredux.com/blog/2013/08/21/color-themes-redux/">this post</a>.
</li>
</ul>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/modules/people/manifests/jedcn/homebrew.pp">modules/people/manifests/jedcn/homebrew.pp</a>.
</p>
</div>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7"><span class="section-number-3">1.7</span> Git Configuration</h3>
<div class="outline-text-3" id="text-1-7">
<div class="org-src-container">

<pre>
<code class='language-ruby'>class people::jedcn::git {
  git::config::global { 'core.editor':
    value  =&gt; '/opt/boxen/homebrew/bin/emacsclient'
  }
  git::config::global { 'push.default':
    value  =&gt; 'simple'
  }
}
</code></pre>
</div>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/modules/people/manifests/jedcn/git.pp">modules/people/manifests/jedcn/git.pp</a>.
</p>
</div>
</div>

<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8"><span class="section-number-3">1.8</span> One Concern per File</h3>
<div class="outline-text-3" id="text-1-8">
<p>
Content at <code>modules/people/manifests/jedcn.pp</code> will only run if the
current user is jedcn.
</p>

<div class="org-src-container">

<pre>
<code class='language-ruby'>class people::jedcn {
  include people::jedcn::applications
  include people::jedcn::git
  include people::jedcn::homebrew
  include people::jedcn::links
  include people::jedcn::osx_config
  include people::jedcn::repositories
}
</code></pre>
</div>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/modules/people/manifests/jedcn.pp">modules/people/manifests/jedcn.pp</a>.
</p>
</div>
</div>

<div id="outline-container-sec-1-9" class="outline-3">
<h3 id="sec-1-9"><span class="section-number-3">1.9</span> Bootstrapping</h3>
<div class="outline-text-3" id="text-1-9">
<div class="org-src-container">

<pre class="src src-sh">xcode-select --install
sudo mkdir -p /opt/boxen
sudo chown ${USER}:staff /opt/boxen
git clone https://github.com/jedcn/mac-config /opt/boxen/repo
/opt/boxen/repo/script/boxen
</code></pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-10" class="outline-3">
<h3 id="sec-1-10"><span class="section-number-3">1.10</span> Literate Programming</h3>
<div class="outline-text-3" id="text-1-10">
<p>
<b>This</b> is an experiment in using <a href="http://en.wikipedia.org/wiki/Literate_programming">Literate Programming</a> to describe
how I configure my computer.
</p>

<p>
A single file generates much of my boxen configuration and this
website.
</p>

<p>
It is available here
<a href="https://github.com/jedcn/mac-config/blob/master/README.org">https://github.com/jedcn/mac-config/blob/master/README.org</a>.
</p>

<p>
Here are the instructions:
</p>

<div class="org-src-container">

<pre>
<code class='language-ruby'>def run(c)
  require 'open3'
  _stdin, stdout, stderr = Open3.popen3(c)
  [ stdout.gets, stderr.gets, $?.to_i ]
end

task :emacs_installed do
  location = `which emacs`
  raise 'Unable to find emacs' if location.empty?
end

task default: :tangle
</code></pre>
</div>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/Rakefile">Rakefile</a>.
</p>

<div class="org-src-container">

<pre>
<code class='language-ruby'>def tangle_file_using_emacs(file)
  args = '--no-init-file --no-site-file --batch'
  tangle_elisp =
    %Q|(progn (require 'ob-tangle) (org-babel-tangle-file \\"#{file}\\"))|
  command = %Q|emacs #{args} --eval "#{tangle_elisp}"|
  _stdout, stderr, status = run(command)
  puts stderr unless status == 0
end

desc 'tangle literate source into puppet'
task :tangle =&gt; :emacs_installed do
  tangle_file_using_emacs('README.org')
end
</code></pre>
</div>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/rakelib/tangle.rake">rakelib/tangle.rake</a>.
</p>

<p>
When it comes to the index.html of the website:
</p>

<div class="org-src-container">

<pre>
<code class='language-markup'>&lt;!DOCTYPE html&gt;
&lt;!--[if lt IE 7]&gt;      &lt;html class="no-js lt-ie9 lt-ie8 lt-ie7"&gt; &lt;![endif]--&gt;
&lt;!--[if IE 7]&gt;         &lt;html class="no-js lt-ie9 lt-ie8"&gt; &lt;![endif]--&gt;
&lt;!--[if IE 8]&gt;         &lt;html class="no-js lt-ie9"&gt; &lt;![endif]--&gt;
&lt;!--[if gt IE 8]&gt;&lt;!--&gt; &lt;html class="no-js"&gt; &lt;!--&lt;![endif]--&gt;
    &lt;head&gt;
	&lt;meta charset="utf-8"&gt;
	&lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"&gt;
	&lt;title&gt;Mac Config&lt;/title&gt;
	&lt;meta name="description" content=""&gt;
	&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;

	&lt;link rel="stylesheet" href="css/bootstrap.min.css"&gt;
	&lt;style&gt;
	    body {
		padding-top: 50px;
		padding-bottom: 20px;
	    }
	&lt;/style&gt;
	&lt;link rel="stylesheet" href="css/bootstrap-theme.min.css"&gt;
	&lt;link rel="stylesheet" href="css/prism.css"&gt;
	&lt;link rel="stylesheet" href="css/main.css"&gt;

	&lt;script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"&gt;&lt;/script&gt;
	&lt;script src="js/vendor/prism.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
	&lt;!--[if lt IE 7]&gt;
	    &lt;p class="browsehappy"&gt;You are using an &lt;strong&gt;outdated&lt;/strong&gt; browser. Please &lt;a href="http://browsehappy.com/"&gt;upgrade your browser&lt;/a&gt; to improve your experience.&lt;/p&gt;
	&lt;![endif]--&gt;

    &lt;div class="container"&gt;

      &lt;%= content %&gt;

      &lt;hr&gt;

      &lt;footer&gt;
	&lt;p&gt;
	  &lt;img title=":money_with_wings:" alt=":money_with_wings:"
	       src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4b8.png"&gt;
	&lt;/p&gt;
      &lt;/footer&gt;
    &lt;/div&gt; &lt;!-- /container --&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
</div>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/rakelib/index.html.erb">rakelib/index.html.erb</a>.
</p>

<p>
When it comes to building up a Github Pages site (supporting js,
css):
</p>

<div class="org-src-container">

<pre>
<code class='language-ruby'>require 'rake/clean'

desc 'Create Github Pages content'
task 'build-gh-pages' =&gt; [ 'gh-pages',
			   'gh-pages-supporting-content',
			   'gh-pages/index.html' ]

directory 'gh-pages'
directory 'tmp'

#
# Extract supporting content from HTML5BoilerPlate
#
task 'gh-pages-supporting-content' =&gt; [ 'gh-pages/favicon.ico',
					'gh-pages/css/bootstrap.min.css',
					'gh-pages/css/bootstrap-theme.min.css',
					'gh-pages/js/vendor/modernizr-2.8.3-respond-1.4.2.min.js' ]

CLEAN.include('tmp/initializr.zip')
CLEAN.include('tmp/initializr')

file 'tmp/initializr' =&gt; [ 'tmp' ] do
  chdir('tmp') do
    `wget -O initializr.zip 'http://www.initializr.com/builder?boot-hero&amp;jquerymin&amp;h5bp-iecond&amp;h5bp-chromeframe&amp;h5bp-analytics&amp;h5bp-favicon&amp;h5bp-appletouchicons&amp;modernizrrespond&amp;izr-emptyscript&amp;boot-css&amp;boot-scripts'`
    `unzip initializr.zip`
  end
end

#
# Setup files from HTML5BoilerPlate
#
def cp_from_initializr(file, dir=nil)
  dest =
    if dir
      "gh-pages/#{dir}"
    else
      'gh-pages'
    end
  FileUtils.cp("tmp/initializr/#{file}", dest, verbose: true)
end

directory 'gh-pages/css' =&gt; 'gh-pages'
directory 'gh-pages/js' =&gt; 'gh-pages'
directory 'gh-pages/js/vendor' =&gt; 'gh-pages/js'

file 'gh-pages/favicon.ico' =&gt; 'tmp/initializr' do
  cp_from_initializr('favicon.ico')
end

file 'gh-pages/css/bootstrap.min.css' =&gt; 'gh-pages/css' do
  cp_from_initializr('css/bootstrap.min.css', 'css')
end

file 'gh-pages/css/bootstrap-theme.min.css' =&gt; 'gh-pages/css' do
  cp_from_initializr('css/bootstrap-theme.min.css', 'css')
end

file 'gh-pages/js/vendor/modernizr-2.8.3-respond-1.4.2.min.js' =&gt;
     'gh-pages/js/vendor' do
  cp_from_initializr('js/vendor/modernizr-2.8.3-respond-1.4.2.min.js',
		     'js/vendor')
end

directory 'gh-pages/css' =&gt; 'gh-pages'

file 'README.html' =&gt; :emacs_installed do
  export_html_using_emacs('README.org')
end

file 'gh-pages/index.html' =&gt; [ 'gh-pages', 'README.html' ] do

  require 'erb'
  require 'ostruct'

  class ContentWrapper &lt; OpenStruct
    def render(template)
      ERB.new(template).result(binding)
    end
  end

  template = File.read('rakelib/index.html.erb')

  content = File.read('README.html')

  cw = ContentWrapper.new({ content: content })
  File.open('gh-pages/index.html', 'w') do |file|
    file.write(cw.render(template))
  end

  rendered = File.read('gh-pages/index.html')
  ruby = "&lt;pre&gt;\n&lt;code class='language-ruby'&gt;"
  rendered = rendered.gsub('&lt;pre class="src src-puppet"&gt;', ruby)
  rendered = rendered.gsub('&lt;pre class="src src-ruby"&gt;', ruby)

  html = "&lt;pre&gt;\n&lt;code class='language-markup'&gt;"
  rendered = rendered.gsub('&lt;pre class="src src-html"&gt;', html)

  rendered = rendered.gsub('&lt;/pre&gt;', '&lt;/code&gt;&lt;/pre&gt;')
  File.open('gh-pages/index.html', 'w') do |file|
    file.write(rendered)
  end
  rm 'README.html', verbose: true
end

def export_html_using_emacs(file)
  args = '--no-init-file --no-site-file --batch'
  tangle_elisp =
    %Q|(progn (require 'org) (find-file (expand-file-name \\"#{file}\\" \\"`pwd`\\")) (org-html-export-to-html nil nil nil t))|
  command = %Q|emacs #{args} --eval "#{tangle_elisp}"|
  stdout, stderr, _status = run(command)
  puts stderr
  puts stdout
end
</code></pre>
</div>

<p>
See <a href="https://github.com/jedcn/mac-config/blob/master/rakelib/ghpages.rake">rakelib/ghpages.rake</a>.
</p>
</div>
</div>
</div>


      <hr>

      <footer>
        <p>
          <img title=":money_with_wings:" alt=":money_with_wings:"
               src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4b8.png">
        </p>
      </footer>
    </div> <!-- /container -->
    </body>
</html>
